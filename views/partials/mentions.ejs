<!-- Most mentioned -->
<div class="widget-container boxed">
  <div class="inner">
    <h3 class="widget-title">
      Most Commonly Mentioned Users
      <div class="tip">
          <img src="/assets/images/info.png">
          <div class="tiptext">
          	<p>[Click on a bar to see the relevant tweets]</p>
          	<p>This chart shows users who are being most often mentioned, retweeted, and replied to.</p>
            <p>Use this chart to assess which users are most actively engaging in conversations, and who other users believe to be relevant.</p>
          </div>
      </div>
    </h3>
      <div class="chart-stage" id="mentions_chart"></div>
  </div>
</div>

<script type="text/javascript">
  
  function makeMentionsChart() {

    var data = new google.visualization.DataTable();
    data.addColumn('string', 'User');
    data.addColumn('number', 'Count');

    for (i = 0; i < days.length; i++) {
      for (j = 0; j < days[i].top_mentioned.length; j++) {
        data.addRow([
          days[i].top_mentioned[j]._id,
          days[i].top_mentioned[j].count
        ])
      }
    }

    data = google.visualization.data.group(data, [0], [{'column': 1, 'aggregation': google.visualization.data.sum, 'type': 'number'}])
    data.sort({column:1, desc:true})
    data.removeRows(20, data.getNumberOfRows() - 20)

    var chart = new google.charts.Bar(document.getElementById('mentions_chart'));

    google.visualization.events.addListener(chart, 'select', function() {
      var target = data.getValue(chart.getSelection()[0].row, 0)
      window.open("https://twitter.com/search?f=tweets&q=%40"+target+"%20%23"+hashtag+"&src=typd ")
    })
    
    chart.draw(data, barOptions);
  }
</script>